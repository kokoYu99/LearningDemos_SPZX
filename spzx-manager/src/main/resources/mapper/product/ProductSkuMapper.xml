<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.koko.spzx.mapper.ProductSkuMapper">


    <!--    int deleteSkuByProductId(Long productId);  -->
    <update id="deleteSkuByProductId">
        UPDATE `product_sku`
        SET is_deleted=1 , update_time=NOW()
        WHERE product_id=#{productId}
    </update>


    <!--   int updateSku(ProductSku sku);  -->
    <update id="updateSku">
        UPDATE `product_sku`
        <set>
            <if test="skuCode != null and skuCode != ''">
                sku_code = #{skuCode},
            </if>
            <if test="skuName != null and skuName != ''">
                sku_name = #{skuName},
            </if>
            <if test="productId != null and productId != ''">
                product_id = #{productId},
            </if>
            <if test="thumbImg != null and thumbImg != ''">
                thumb_img = #{thumbImg},
            </if>
            <if test="salePrice != null and salePrice != ''">
                sale_price = #{salePrice},
            </if>
            <if test="marketPrice != null and marketPrice != ''">
                market_price = #{marketPrice},
            </if>
            <if test="costPrice != null and costPrice != ''">
                cost_price = #{costPrice},
            </if>
            <if test="stockNum != null and stockNum != ''">
                stock_num = #{stockNum},
            </if>
            <if test="skuSpec != null and skuSpec != ''">
                sku_spec = #{skuSpec},
            </if>
            <if test="weight != null and weight != ''">
                weight = #{weight},
            </if>
            <if test="volume != null and volume != ''">
                volume = #{volume},
            </if>
            <if test="status != null and status != ''">
                status = #{status},
            </if>
            <if test="saleNum != null and saleNum != ''">
                sale_num = #{saleNum},
            </if>
            update_time=NOW()
        </set>
        WHERE id=#{id}
    </update>


    <!--      List<ProductSku> findSkusByProductId(Long productId);  -->
    <select id="findSkusByProductId" resultType="com.koko.spzx.model.entity.product.ProductSku">
        SELECT
        id,
        sku_code,
        sku_name,
        product_id,
        thumb_img,
        sale_price,
        market_price,
        cost_price,
        stock_num,
        sku_spec,
        weight,
        volume,
        status,
        sale_num
        FROM `product_sku`
        WHERE product_id=#{productId} AND is_deleted=0
        ORDER BY id DESC
    </select>


    <!--    int insertSku(ProductSku productSku);  -->
    <insert id="insertSku" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO `product_sku` (
        sku_code,
        sku_name,
        product_id,
        thumb_img,
        sale_price,
        market_price,
        cost_price,
        stock_num,
        sku_spec,
        weight,
        volume,
        status,
        sale_num)
        VALUES (
        #{skuCode},
        #{skuName},
        #{productId},
        #{thumbImg},
        #{salePrice},
        #{marketPrice},
        #{costPrice},
        #{stockNum},
        #{skuSpec},
        #{weight},
        #{volume},
        #{status},
        #{saleNum}
        )
    </insert>


</mapper>